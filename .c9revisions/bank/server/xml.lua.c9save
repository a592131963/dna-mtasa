{"ts":1350329691199,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\r\n--[[\r\n\r\n    Resource:   bank (written by 50p)\r\n    Version:    2.3\r\n    \r\n    Filename:   bank.xml.server.lua\r\n\r\n]]\r\n\r\n\r\nbankSQLInfo = { }\r\nbanksInfo = { }\r\n\r\n\r\nfunction bankInit( )\r\n\tlocal useATMs = get( \"bank.useATMs\" )\r\n    local xml_root = xmlLoadFile( \"bank.locations.xml\" )\r\n    local banks = 0\r\n    while( xmlFindChild( xml_root, \"bank\", banks ) ) do\r\n\t\tlocal markerSize\r\n        local tempID = banks+1\r\n        banksInfo[ tempID ] = { }\r\n        \r\n        local bank_node = xmlFindChild( xml_root, \"bank\", banks )\r\n        banksInfo[ tempID ].name = xmlNodeGetAttribute( bank_node, \"name\" )\r\n\t\tbanksInfo[ tempID ].useBlip = xmlNodeGetAttribute( bank_node, \"blip\" ) or true\r\n\t\tbanksInfo[ tempID ].depositAllowed = xmlNodeGetAttribute( bank_node, \"depositAllowed\" ) or true\r\n\t\t\r\n        local bank_loc = xmlFindChild( bank_node, \"location\", 0 )\r\n        banksInfo[ tempID ].posX = tonumber( xmlNodeGetAttribute( bank_loc, \"posX\" ) )\r\n        banksInfo[ tempID ].posY = tonumber( xmlNodeGetAttribute( bank_loc, \"posY\" ) )\r\n        banksInfo[ tempID ].posZ = tonumber( xmlNodeGetAttribute( bank_loc, \"posZ\" ) )\r\n        banksInfo[ tempID ].interior = tonumber( xmlNodeGetAttribute( bank_loc, \"interior\" ) ) or 0;\r\n\t\tmarkerSize = tonumber( xmlNodeGetAttribute( bank_loc, \"markerSize\" ) ) or 2\r\n\t\tbanksInfo[ tempID ].marker = createMarker( \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ].posX,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ].posY,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ].posZ-.9,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"cylinder\", markerSize, 250, 0, 0, 100 )\r\n\t\tsetElementInterior( banksInfo[ tempID ].marker, banksInfo[ tempID ].interior );\r\n\t\tif useATMs and xmlNodeGetAttribute( bank_loc, \"ATM\" ) == \"true\" then\r\n\t\t\tlocal rot = tonumber( xmlNodeGetAttribute( bank_loc, \"ATMRot\" ) ) or 0.0\r\n\t\t\tlocal x, y, z = banksInfo[ tempID ].posX, banksInfo[ tempID ].posY, banksInfo[ tempID ].posZ\r\n\t\t\tx = x + math.sin( math.rad( rot ) ) * .6\r\n\t\t\ty = y + math.cos( math.rad( rot ) ) * .6\r\n\t\t\tbanksInfo[ tempID ].ATM = createObject( 2942, x, y, z-.35, 0, 0, (360-rot) ) \r\n\t\t\tsetElementInterior( banksInfo[ tempID ].ATM, tonumber( xmlNodeGetAttribute( bank_loc, \"interior\" ) ) or 0 )\r\n\t\t\tsetElementParent( banksInfo[ tempID ].ATM, banksInfo[ tempID ].marker )\r\n\t\tend\r\n\r\n        if xmlFindChild( bank_node, \"entrance\", 0 ) then\r\n            banksInfo[ tempID ].entrance = { }\r\n            local entrance_node = xmlFindChild( bank_node, \"entrance\", 0 )\r\n            banksInfo[ tempID ].entrance.posX = xmlNodeGetAttribute( entrance_node, \"posX\" )\r\n            banksInfo[ tempID ].entrance.posY = xmlNodeGetAttribute( entrance_node, \"posY\" )\r\n            banksInfo[ tempID ].entrance.posZ = xmlNodeGetAttribute( entrance_node, \"posZ\" )\r\n            banksInfo[ tempID ].entrance.interior = tonumber( xmlNodeGetAttribute( entrance_node, \"interior\" ) ) or 0;\r\n            banksInfo[ tempID ].entrance.teleX = xmlNodeGetAttribute( entrance_node, \"teleX\" )\r\n            banksInfo[ tempID ].entrance.teleY = xmlNodeGetAttribute( entrance_node, \"teleY\" )\r\n            banksInfo[ tempID ].entrance.teleZ = xmlNodeGetAttribute( entrance_node, \"teleZ\" )\r\n            banksInfo[ tempID ].entrance.teleRot = xmlNodeGetAttribute( entrance_node, \"teleRot\" )\r\n            banksInfo[ tempID ].entrance.teleInterior = xmlNodeGetAttribute( entrance_node, \"teleInterior\" )\r\n            banksInfo[ tempID ].entrance.marker = createMarker(\r\n                                                                banksInfo[ tempID ].entrance.posX,\r\n                                                                banksInfo[ tempID ].entrance.posY,\r\n                                                                banksInfo[ tempID ].entrance.posZ-1,\r\n                                                                \"cylinder\", 1.5, 250, 250, 0, 100 )\r\n            --local blip = createBlipAttachedTo( banksInfo[ tempID ].entrance.marker, 52 )\r\n\t\t\tlocal col = createColTube( banksInfo[ tempID ].entrance.posX, banksInfo[ tempID ].entrance.posY, banksInfo[ tempID ].entrance.posZ-180, 150, 360 )\r\n\t\t\tsetElementParent( banksInfo[ tempID ].entrance.marker, col )\r\n\t\t\tsetElementInterior( banksInfo[ tempID ].entrance.marker, banksInfo[ tempID ].entrance.interior );\r\n\t\t\t\r\n        elseif ( type( banksInfo[ tempID ].useBlip ) == \"boolean\" and banksInfo[ tempID ].useBlip == true )\r\n\t\t\tor ( type( banksInfo[ tempID ].useBlip ) == \"string\" and banksInfo[ tempID ].useBlip == \"true\" )\r\n\t\tthen\r\n\t\t\tlocal col = createColTube( banksInfo[ tempID ].posX, banksInfo[ tempID ].posY, banksInfo[ tempID ].posZ-180, 150, 360 )\r\n\t\t\tsetElementParent( banksInfo[ tempID ].marker, col )\r\n        end\r\n        if xmlFindChild( bank_node, \"exit\", 0 ) and banksInfo[ tempID ].entrance then\r\n            banksInfo[ tempID ]._exit = { }\r\n            local exit_node = xmlFindChild( bank_node, \"exit\", 0 )\r\n            banksInfo[ tempID ]._exit.posX = xmlNodeGetAttribute( exit_node, \"posX\" )\r\n            banksInfo[ tempID ]._exit.posY = xmlNodeGetAttribute( exit_node, \"posY\" )\r\n            banksInfo[ tempID ]._exit.posZ = xmlNodeGetAttribute( exit_node, \"posZ\" )\r\n            banksInfo[ tempID ]._exit.interior = tonumber( xmlNodeGetAttribute( exit_node, \"interior\" ) ) or 0;\r\n            banksInfo[ tempID ]._exit.teleX = xmlNodeGetAttribute( exit_node, \"teleX\" )\r\n            banksInfo[ tempID ]._exit.teleY = xmlNodeGetAttribute( exit_node, \"teleY\" )\r\n            banksInfo[ tempID ]._exit.teleZ = xmlNodeGetAttribute( exit_node, \"teleZ\" )\r\n            banksInfo[ tempID ]._exit.teleRot = xmlNodeGetAttribute( exit_node, \"teleRot\" )\r\n            banksInfo[ tempID ]._exit.teleInterior = xmlNodeGetAttribute( exit_node, \"teleInterior\" )\r\n            banksInfo[ tempID ]._exit.marker = createMarker( \r\n                                                            banksInfo[ tempID ]._exit.posX,\r\n                                                            banksInfo[ tempID ]._exit.posY,\r\n                                                            banksInfo[ tempID ]._exit.posZ-1,\r\n                                                            \"cylinder\", 1.5, 250, 250, 0, 100 )\r\n\t\t\tsetElementInterior( banksInfo[ tempID ]._exit.marker, banksInfo[ tempID ]._exit.interior );\r\n        end\r\n        banks = banks + 1\r\n    end\r\n\t\r\n\tbankSQLInfo.tab = get( \"bank.SQLTable\" )\r\n\tbankSQLInfo.username = get( \"bank.SQLUserNameField\" )\r\n\tbankSQLInfo.balance = get( \"bank.SQLMoneyField\" )\r\n\tif not bankSQLInfo.tab then\r\n\t\tbankSQLInfo.tab = \"bank_accounts\"\r\n\tend\r\n\tif not bankSQLInfo.username then\r\n\t\tbankSQLInfo.username = \"username\"\r\n\tend\r\n\tif not bankSQLInfo.balance then\r\n\t\tbankSQLInfo.balance = \"balance\"\r\n\tend\r\nend\r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":6610}]],"length":6610}
{"contributors":[],"silentsave":false,"ts":1350293706202,"patch":[[{"diffs":[[0,"--[[\r\n\r\n"],[-1,"    "],[1,"\t"],[0,"Resource"]],"start1":2,"start2":2,"length1":20,"length2":17},{"diffs":[[0,"p)\r\n"],[-1,"    "],[1,"\t"],[0,"Version:"],[-1,"    "],[1,"\t"],[0,"2.3\r\n"],[-1,"    \r\n    "],[1,"\t\r\n\t"],[0,"File"]],"start1":42,"start2":42,"length1":39,"length2":27},{"diffs":[[0,"useATMs\" )\r\n"],[-1,"    "],[1,"\t"],[0,"local xml_ro"]],"start1":198,"start2":198,"length1":28,"length2":25},{"diffs":[[0,"xml\" )\r\n"],[-1,"    "],[1,"\t"],[0,"local ba"]],"start1":257,"start2":257,"length1":20,"length2":17},{"diffs":[[0,"ks = 0\r\n"],[-1,"    "],[1,"\t"],[0,"while( x"]],"start1":275,"start2":275,"length1":20,"length2":17},{"diffs":[[0,"erSize\r\n"],[-1,"        "],[1,"\t\t"],[0,"local te"]],"start1":349,"start2":349,"length1":24,"length2":18},{"diffs":[[0,"anks+1\r\n"],[-1,"        "],[1,"\t\t"],[0,"banksInf"]],"start1":375,"start2":375,"length1":24,"length2":18},{"diffs":[[0," }\r\n"],[-1,"        \r\n        "],[1,"\r\n\t\t"],[0,"loca"]],"start1":408,"start2":408,"length1":26,"length2":12},{"diffs":[[0,"\", banks )\r\n"],[-1,"        "],[1,"\t\t"],[0,"banksInfo[ t"]],"start1":463,"start2":463,"length1":32,"length2":26},{"diffs":[[0,"ue\r\n\t\t\r\n"],[-1,"        "],[1,"\t\t"],[0,"local ba"]],"start1":723,"start2":723,"length1":24,"length2":18},{"diffs":[[0,"tion\", 0 )\r\n"],[-1,"        "],[1,"\t\t"],[0,"banksInfo[ t"]],"start1":780,"start2":780,"length1":32,"length2":26},{"diffs":[[0,"\"posX\" ) )\r\n"],[-1,"        "],[1,"\t\t"],[0,"banksInfo[ t"]],"start1":862,"start2":862,"length1":32,"length2":26},{"diffs":[[0,"\"posY\" ) )\r\n"],[-1,"        "],[1,"\t\t"],[0,"banksInfo[ t"]],"start1":944,"start2":944,"length1":32,"length2":26},{"diffs":[[0,"Z\" ) )\r\n"],[-1,"        "],[1,"\t\t"],[0,"banksInf"]],"start1":1030,"start2":1030,"length1":24,"length2":18},{"diffs":[[0,"\tend\r\n\r\n"],[-1,"        "],[1,"\t\t"],[0,"if xmlFi"]],"start1":2128,"start2":2128,"length1":24,"length2":18},{"diffs":[[0,", 0 ) then\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2176,"start2":2176,"length1":36,"length2":27},{"diffs":[[0,"ance = { }\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"local entran"]],"start1":2215,"start2":2215,"length1":36,"length2":27},{"diffs":[[0,"ance\", 0 )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2282,"start2":2282,"length1":36,"length2":27},{"diffs":[[0,", \"posX\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2367,"start2":2367,"length1":36,"length2":27},{"diffs":[[0,", \"posY\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2452,"start2":2452,"length1":36,"length2":27},{"diffs":[[0,", \"posZ\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2537,"start2":2537,"length1":36,"length2":27},{"diffs":[[0," ) ) or 0;\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2648,"start2":2648,"length1":36,"length2":27},{"diffs":[[0," \"teleX\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2735,"start2":2735,"length1":36,"length2":27},{"diffs":[[0," \"teleY\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2822,"start2":2822,"length1":36,"length2":27},{"diffs":[[0," \"teleZ\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":2909,"start2":2909,"length1":36,"length2":27},{"diffs":[[0,"teleRot\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":3000,"start2":3000,"length1":36,"length2":27},{"diffs":[[0,"nterior\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":3101,"start2":3101,"length1":36,"length2":27},{"diffs":[[0,"r(\r\n"],[-1,"                                                                banksInfo[ tempID ].entrance.posX,\r\n                                                                banksInfo[ tempID ].entrance.posY,\r\n                                                                banksInfo[ tempID ].entrance.posZ-1,\r\n                                                                "],[1,"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ].entrance.posX,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ].entrance.posY,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ].entrance.posZ-1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"],[0,"\"cyl"]],"start1":3165,"start2":3165,"length1":374,"length2":182},{"diffs":[[0," 100 )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"--local "]],"start1":3372,"start2":3372,"length1":28,"length2":19},{"diffs":[[0,";\r\n\t\t\t\r\n"],[-1,"        "],[1,"\t\t"],[0,"elseif ("]],"start1":3778,"start2":3778,"length1":24,"length2":18},{"diffs":[[0," col )\r\n"],[-1,"        end\r\n        "],[1,"\t\tend\r\n\t\t"],[0,"if xmlFi"]],"start1":4170,"start2":4170,"length1":37,"length2":25},{"diffs":[[0,"e then\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInf"]],"start1":4258,"start2":4258,"length1":28,"length2":19},{"diffs":[[0," = { }\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"local ex"]],"start1":4294,"start2":4294,"length1":28,"length2":19},{"diffs":[[0,"exit\", 0 )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4349,"start2":4349,"length1":36,"length2":27},{"diffs":[[0,", \"posX\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4427,"start2":4427,"length1":36,"length2":27},{"diffs":[[0,", \"posY\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4505,"start2":4505,"length1":36,"length2":27},{"diffs":[[0,", \"posZ\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4583,"start2":4583,"length1":36,"length2":27},{"diffs":[[0," or 0;\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInf"]],"start1":4691,"start2":4691,"length1":28,"length2":19},{"diffs":[[0," \"teleX\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4767,"start2":4767,"length1":36,"length2":27},{"diffs":[[0," \"teleY\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4847,"start2":4847,"length1":36,"length2":27},{"diffs":[[0," \"teleZ\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":4927,"start2":4927,"length1":36,"length2":27},{"diffs":[[0,"teleRot\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInfo[ t"]],"start1":5011,"start2":5011,"length1":36,"length2":27},{"diffs":[[0,"ior\" )\r\n"],[-1,"            "],[1,"\t\t\t"],[0,"banksInf"]],"start1":5109,"start2":5109,"length1":28,"length2":19},{"diffs":[[0,"( \r\n"],[-1,"                                                            banksInfo[ tempID ]._exit.posX,\r\n                                                            banksInfo[ tempID ]._exit.posY,\r\n                                                            banksInfo[ tempID ]._exit.posZ-1,\r\n                                                            "],[1,"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ]._exit.posX,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ]._exit.posY,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbanksInfo[ tempID ]._exit.posZ-1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t"],[0,"\"cyl"]],"start1":5167,"start2":5167,"length1":349,"length2":169},{"diffs":[[0,");\r\n"],[-1,"        end\r\n        "],[1,"\t\tend\r\n\t\t"],[0,"bank"]],"start1":5461,"start2":5461,"length1":29,"length2":17},{"diffs":[[0," 1\r\n"],[-1,"    "],[1,"\t"],[0,"end\r"]],"start1":5489,"start2":5489,"length1":12,"length2":9}]],"length":5888,"saved":false}
